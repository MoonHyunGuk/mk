SELECT 
			
				C.GNO AS GROUPBYTYPE
      , NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM <= '201112' AND C.YYMM = '201112' THEN C.QTY END),0) AS READTYPECD011						
			, NVL(SUM(CASE WHEN C.READTYPECD = '012' THEN C.QTY END),0) AS READTYPECD012																		
			, NVL(SUM(CASE WHEN C.READTYPECD = '013' THEN C.QTY END),0) AS READTYPECD013																		
			, NVL(SUM(CASE WHEN C.READTYPECD = '014' THEN C.QTY END),0) AS READTYPECD014																		
			, NVL(SUM(CASE WHEN C.READTYPECD = '015' THEN C.QTY END),0) AS READTYPECD015																		
			, NVL(SUM(CASE WHEN C.READTYPECD = '021' THEN C.QTY END),0) AS READTYPECD021																		
			, NVL(SUM(CASE WHEN C.READTYPECD = '022' THEN C.QTY END),0) AS READTYPECD022			
      , NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201201' AND C.YYMM = '201201' THEN C.QTY END),0) AS SUM_QTY1														-- 준유가(1개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201202' AND C.YYMM = '201202' THEN C.QTY END),0) AS SUM_QTY2														-- 준유가(2개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201203' AND C.YYMM = '201203' THEN C.QTY END),0) AS SUM_QTY3														-- 준유가(3개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201204' AND C.YYMM = '201204' THEN C.QTY END),0) AS SUM_QTY4														-- 준유가(4개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201205' AND C.YYMM = '201205' THEN C.QTY END),0) AS SUM_QTY5														-- 준유가(5개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM = '201206' AND C.YYMM = '201206' THEN C.QTY END),0) AS SUM_QTY6														-- 준유가(6개월) 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM >= '201207' AND C.YYMM = '201207' THEN C.QTY END),0) AS SUM_QTY7													-- 기타 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '031' THEN C.QTY END),0) AS SUM_ETC_LOSS																							-- 결손 부수 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '032' THEN C.QTY END),0) AS SUM_ETC_FINANCE																						-- 재무 부수 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '033' THEN C.QTY END),0) AS SUM_ETC_LEAVE																						-- 휴독 부수 
			, NVL(SUM(CASE WHEN C.READTYPECD = '011' AND C.SGBGMM <= '201112' AND C.YYMM = '201112' AND C.UPRICE/C.QTY = '15000' THEN C.QTY END),0) AS SUM_LIST_PRICE					-- 일반독자중 구독료가 정가인 독자 
			, NVL(SUM(CASE WHEN C.SGBBCD = '044' AND C.YYMM = TO_CHAR(ADD_MONTHS(TO_DATE('201112','YYYYMM'), -1) , 'YYYYMM') THEN C.BILLAMT END),0) AS SUM_MISU_AMT									-- 매출액중 미수된 금액 (전월미수)
			, NVL(SUM(CASE WHEN C.SGBBCD = '044' AND C.YYMM < '201112' THEN C.BILLAMT END),0) AS SUM_ALL_MISU_AMT																				-- 매출액중 미수된 금액 (총 전월미수)
			, NVL(SUM(CASE WHEN C.YYMM < '201112' AND C.SGYYMM >= '201112' AND C.SGBBCD != '044' THEN C.BILLAMT END),0) AS SUM_MISU_AFTER														-- 현재월 이후에 입금된 미수 
			, NVL(SUM(CASE WHEN C.YYMM = '201112' THEN C.BILLAMT END),0) AS MONTH_SUGUM																												-- 당월수금예정액 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.YYMM = '201112' AND C.SGBBCD IN ('011','012','013','014','021','022','023','024') THEN C.AMT END),0) AS SUM_YUGA_SINSU					-- 유가조정액 중 신수 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.YYMM < '201112' AND C.SGBBCD IN ('011','012','013','014','021','022','023','024') THEN C.AMT END),0) AS SUM_YUGA_MISU					-- 유가조정액 중 미수 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD IN ('031','032','033') THEN C.AMT END),0) + NVL(SUM(CASE WHEN C.SGYYMM = '201112' THEN C.LOSSAMT END),0) AS SUM_ETC1				-- 재무,결손,휴독 금액 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND '201112' < C.YYMM AND C.SGBBCD IN ('011','012','013','014','021','022','023','024') THEN C.AMT END),0) AS SUM_DEPOSIT					-- 선입금 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '011' THEN C.AMT END),0) AS SUM_SGBBCD011  																						-- 지로 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '012' THEN C.AMT END),0) AS SUM_SGBBCD012  																						-- 방문 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '013' THEN C.AMT END),0) AS SUM_SGBBCD013  																						-- 통장입금 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '021' THEN C.AMT END),0) AS SUM_SGBBCD021  																						-- 자동이체 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD = '022' THEN C.AMT END),0) AS SUM_SGBBCD022  																						-- 카드 
			, NVL(SUM(CASE WHEN C.SGYYMM = '201112' AND C.SGBBCD IN ('014','023','024','031','032','033') THEN C.AMT END),0) AS SUM_ETC2 															-- 기타 
			, NVL(SUM(CASE WHEN C.SGBBCD = '044' THEN C.BILLAMT END),0) AS SUM_MISU                                                                                                                 --미수총계
      , NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD IN ('031','032','033') THEN C.AMT END),0) + NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' THEN C.LOSSAMT END),0) AS MON_SUM_ETC1		 --당월 재무,결손,휴독
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGBBCD = '044' THEN C.BILLAMT END),0) AS MON_SUM_MISU  																						--당월 미수총계
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD = '011' THEN C.AMT END),0) AS MON_SUM_SGBBCD011  															--당월 지로
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD = '012' THEN C.AMT END),0) AS MON_SUM_SGBBCD012  									  					    --당월 방문
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD = '013' THEN C.AMT END),0) AS MON_SUM_SGBBCD013  															-- 당월 통장입금
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD = '021' THEN C.AMT END),0) AS MON_SUM_SGBBCD021  															--당월 자동이체
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD = '022' THEN C.AMT END),0) AS MON_SUM_SGBBCD022  															-- 당월 카드
			, NVL(SUM(CASE WHEN C.YYMM = '201112' AND C.SGYYMM = '201112' AND C.SGBBCD IN ('014','023','024','031','032','033') THEN C.AMT END),0) AS MON_SUM_ETC2 									--당월 기타
		FROM 
			(
				SELECT 
					A.GNO
					, A.BOSEQ
					, A.READTYPECD
					, A.QTY
					, A.SGBGMM
					, A.SGTYPE
					, A.UPRICE
					, B.YYMM
					, B.SGBBCD
              		, B.SGYYMM
              		, B.BILLAMT
              		, B.AMT
              		, B.LOSSAMT
				FROM
					TM_READER_NEWS A
					, TM_READER_SUGM B 
			WHERE
				A.NEWSCD = B.NEWSCD
				AND
				A.SEQ = B.SEQ
				AND
				A.READNO = B.READNO
				AND 
				A.BOSEQ = B.BOSEQ
				AND 
				A.SEQ > 0
				AND 
				B.SEQ > 0
				AND 
				A.READNO > 0
				AND 
				B.READNO > 0
				AND 
				B.YYMM > 0
				
				AND
				A.BNO != '999'
        and
				a.newscd = '100'
        and
        b.newscd = '100'
				and
					A.BOSEQ = '512009'
				and
					b.BOSEQ = '512009'
			) C
		GROUP BY
			c.gno
		ORDER BY
			
				LENGTH(C.GNO),C.GNO 
			
      